<%- include('../partials/header.ejs') %>

<h2><%= user.first %> <%= user.last %>'s Profile</h2>
<img src="<%= user.picture %>" alt="Profile Picture" width="150">

<div>
    <a href="<%= `/auth/${user._id}/update-password` %>">Update Password</a>
</div>

<h3>Your Listings:</h3>
<ul>
  <% if (user.listings && user.listings.length > 0) { %>
    <% user.listings.forEach(listing => { %>
      <li>
        <strong><%= listing.title %></strong>
        <div><%= listing.description %></div>
        <div>Price: $<%= listing.price %></div>
        <div>Status: <%= listing.status %></div>
        <a href="/listings/<%= listing._id %>/edit">Edit</a>
        <form action="/listings/<%= listing._id %>?_method=DELETE" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this listing?');">
          <button type="submit">Delete</button>
        </form>
      </li>
    <% }) %>
  <% } else { %>
    <p>You havenâ€™t posted any listings yet.</p>
  <% } %>
</ul>

<h3>View All Listings:</h3>
<ul>
  <% if (Array.isArray(listings) && listings.length > 0) { %>
    <% listings.forEach(listing => { %>
      <% if (listing && listing._id && listing.title) { %>
        <li>
          <a href="/listings/<%= listing._id %>"><%= listing.title %></a>
        </li>
      <% } %>
    <% }) %>
  <% } else { %>
    <li>No listings available.</li>
  <% } %>
</ul>

<div>
    <a href="/listings/create">Create New Listing</a>
    <a href="/auth/sign-out">Logout</a>
    <a href="/auth/update">Update Profile</a>
    <a href="/auth/delete">Delete Account</a>
</div>

<%- include('../partials/footer.ejs') %>
<!-- This is a simple profile page for a user in a real estate application. It displays the user's name, profile picture, and their listings. -->


